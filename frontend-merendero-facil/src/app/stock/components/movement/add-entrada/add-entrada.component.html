<div class="container mt-4">
    <h5 style="margin-top: -15px; display: inline-block; padding-bottom: 10px;" class="text-center green-title">
        Agregar Entrada</h5>

    <form [formGroup]="formReactivo" (ngSubmit)="onSubmitForm()" class="">
        <!-- Tipo de entrada -->
        <div class="row mb-3">
            <div class="col-md-12">
                <label class="form-label">Tipo de entrada</label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" formControlName="entryType" id="donation"
                        value="DONATION" checked>
                    <label class="form-check-label" for="donation">
                        Donación
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" formControlName="entryType" id="purchase"
                        value="PURCHASE">
                    <label class="form-check-label" for="purchase">
                        Compra
                    </label>
                </div>
            </div>
        </div>

        <div class="row mb-3">
            <!-- Supply -->
            <div class="col-md-6">
                <label class="form-label">
                    ¿De qué insumo se trata?
                </label>
                <select class="form-select" formControlName="supplyId"
                    [ngClass]="{'is-invalid': formReactivo.get('supplyId')?.invalid && formReactivo.get('supplyId')?.touched}">
                    <option value="">Selecciona un insumo</option>
                    @for (s of supplies; track $index) {
                    <option [value]="s.id">
                        {{ s.name }}
                    </option>
                    }
                </select>

                @if(formReactivo.get('supplyId')?.invalid && formReactivo.get('supplyId')?.touched) {
                @if(formReactivo.get('supplyId')?.hasError('required')) {
                <div class="text-danger align-self-end" style="width: 500px;">Campo requerido</div>
                }
                }

            </div>
            <!-- Cantidad -->
            <div class="col-md-6">
                <label class="form-label">
                    Cantidad
                </label>
                <input class="form-control" type="number" formControlName="quantity"
                    [ngClass]="{'is-invalid': formReactivo.get('quantity')?.invalid && formReactivo.get('quantity')?.touched}">
                @if(formReactivo.get('quantity')?.invalid && formReactivo.get('quantity')?.touched) {
                @if(formReactivo.get('quantity')?.hasError('required')) {
                <div class="text-danger align-self-end" style="width: 500px;">Campo requerido</div>
                }
                @if(formReactivo.get('quantity')?.hasError('min')) {
                <div class="text-danger align-self-end" style="width: 500px;">El mínimo es 1</div>
                }
                }
            </div>
        </div>

        <!-- Expiration Date -->
        <div class="row mb-4">
            <div class="col-md-12">
                <label class="form-label">
                    ¿Cuándo vence esta tanda?
                </label>
                <input class="form-control" type="date" formControlName="expirationDate"
                    [ngClass]="{'is-invalid': formReactivo.get('expirationDate')?.invalid && formReactivo.get('expirationDate')?.touched}">
                @if(formReactivo.get('expirationDate')?.invalid && formReactivo.get('expirationDate')?.touched) {
                @if(formReactivo.get('expirationDate')?.hasError('required')) {
                <div class="text-danger align-self-end" style="width: 500px;">Campo requerido</div>
                }
                @if(formReactivo.get('expirationDate')?.hasError('pastDate')) {
                <div class="text-danger align-self-end" style="width: 500px;">La fecha debe ser posterior a hoy</div>
                }
                }
            </div>
        </div>

        <!-- Campos adicionales por si la entrada de insumos es una compra -->
        @if (formReactivo.get('entryType')?.value === 'PURCHASE') {
        <div class="row mb-3">
            <div class="col-md-12">
                <label class="form-label">
                    Costo (en ARS)
                </label>
                <input class="form-control" type="number" step="0.01" formControlName="cost"
                    [ngClass]="{'is-invalid': formReactivo.get('cost')?.invalid && formReactivo.get('cost')?.touched}">

                @if(formReactivo.get('cost')?.invalid && formReactivo.get('cost')?.touched) {
                @if(formReactivo.get('cost')?.hasError('required')) {
                <div class="text-danger align-self-end" style="width: 500px;">Campo requerido</div>
                }
                @if(formReactivo.get('cost')?.hasError('min')) {
                <div class="text-danger align-self-end" style="width: 500px;">El mínimo es de 1</div>
                }
                }
            </div>
        </div>
        }

        <!-- GUARDAR -->
        <button type="submit" class="green-btn" [disabled]="formReactivo.invalid">
            Registrar Entrada
        </button>
    </form>


    <!-- FOOTER -->
    <div class="mt-4 text-center" style="padding-top: 14px;">
        <a class="footer-link" style="color: #e79e36; text-decoration: none; margin-right: 10px;"
            routerLink="/terminos">Términos y Condiciones <i class="fas fa-external-link-alt fa-xs ms-1"
                aria-hidden="true"></i></a>
        <span> | </span>
        <a class="footer-link" style="color: #e79e36 ; text-decoration: none; margin-left: 10px;"
            routerLink="/preguntas">Preguntas Frecuentes <i class="fas fa-external-link-alt fa-xs ms-1"
                aria-hidden="true"></i></a>
    </div>
</div>